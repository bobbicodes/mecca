(ns ^:figwheel-hooks mecca.events
  (:require
   [re-frame.core :refer [reg-event-db reg-event-fx dispatch subscribe]]
   [re-pressed.core :as rp]
   [ajax.core :as ajax]
   [ajax.protocols :as protocol]
   [day8.re-frame.undo :as undo :refer [undoable]]
   [mecca.mario :as mario :refer [mario]]
   [mecca.music :as music :refer [audiocontext]]
   [goog.events :refer [listen unlisten]])
  (:import [goog.events EventType]))

(reg-event-db
 :initialize-db
 (fn [_ _]
   {:focused-note-pos [nil nil]
    :eraser? false
    :playing? false
    :play-start 0
    :jumping? false
    :sharp? false
    :current-position 0
    :current-note 0
    :next-note-time 0.0
    :notes-in-queue []
    :editor-beat-start 1
    :instrument 1
    :array-buffer nil
    :key "C"
    :time 0
    :time-signature 4
    :tempo 120
    :notes []
    :lead []
    :bassline []
    :drums []
    :mario-x 54
    :mario-y 59
    :mario-jump 0
    :mario-run 1
    :xml ""}))

(dispatch
 [::rp/set-keydown-rules
  {:event-keys [
                [[:jump!]
                 [{:keyCode 13}]
                 [{:keyCode 32}]]]}])
             
(reg-event-db
 :next-note
 (fn [db [_ _]]
   (let [tempo (subscribe [:tempo])
         seconds-per-beat (/ 60.0 @tempo)]
     (update 
      (update db :current-note inc)
      :next-note-time #(+ % seconds-per-beat)))))

(reg-event-db
 :schedule-note
 (fn [db [_ _]]
   (let [notes (subscribe [:notes])
         beat (subscribe [:current-note])
         to-play (filter #(= (+ 1 @beat) (:time %)) @notes)]
     (update db :notes-in-queue
             into to-play))))

(reg-event-db
 :add-note
 (undoable "add note")
 (fn [db [_ instrument time pitch]]
   (if (= (.-state @audiocontext) "suspended")
     (.resume @audiocontext))
   (music/play-sample instrument (if @(subscribe [:sharp?]) (inc pitch) pitch))
   (update db :notes
           conj 
           {:time time
            :instrument instrument
            :pitch (if @(subscribe [:sharp?])
                    (inc pitch) pitch)})))

(reg-event-db
 :load-megaman
 (fn [db [_ notes]]
   (dispatch [:set-tempo 300])
   (assoc db :notes
          ;(music/mmbass)
          [{:time 309, :instrument 3, :pitch 64} {:time 307, :instrument 15, :pitch 64} {:time 306, :instrument 15, :pitch 69} {:time 303, :instrument 15, :pitch 69} {:time 302, :instrument 15, :pitch 71} {:time 301, :instrument 15, :pitch 72} {:time 299, :instrument 15, :pitch 64} {:time 298, :instrument 15, :pitch 69} {:time 295, :instrument 15, :pitch 69} {:time 293, :instrument 15, :pitch 67} {:time 291, :instrument 15, :pitch 62} {:time 290, :instrument 15, :pitch 67} {:time 287, :instrument 15, :pitch 67} {:time 286, :instrument 15, :pitch 62} {:time 283, :instrument 15, :pitch 62} {:time 282, :instrument 15, :pitch 67} {:time 279, :instrument 15, :pitch 67} {:time 277, :instrument 15, :pitch 65} {:time 275, :instrument 15, :pitch 69} {:time 270, :instrument 15, :pitch 60} {:time 267, :instrument 15, :pitch 60} {:time 265, :instrument 2, :pitch 71} {:time 269, :instrument 2, :pitch 69} {:time 267, :instrument 2, :pitch 60} {:time 273, :instrument 2, :pitch 72} {:time 271, :instrument 2, :pitch 62} {:time 277, :instrument 2, :pitch 71} {:time 275, :instrument 2, :pitch 62} {:time 281, :instrument 2, :pitch 72} {:time 279, :instrument 2, :pitch 62} {:time 281.5, :instrument 2, :pitch 74} {:time 283, :instrument 2, :pitch 64} {:time 285, :instrument 2, :pitch 74} {:time 289, :instrument 2, :pitch 69} {:time 287, :instrument 2, :pitch 64} {:time 291, :instrument 2, :pitch 60} {:time 295, :instrument 2, :pitch 62} {:time 301, :instrument 2, :pitch 71} {:time 299, :instrument 2, :pitch 62} {:time 305, :instrument 2, :pitch 71} {:time 303, :instrument 2, :pitch 60} {:time 309, :instrument 2, :pitch 71} {:time 307, :instrument 2, :pitch 62} {:time 310, :instrument 13, :pitch 76} {:time 308, :instrument 13, :pitch 76} {:time 306, :instrument 13, :pitch 76} {:time 304, :instrument 13, :pitch 76} {:time 302, :instrument 13, :pitch 76} {:time 300, :instrument 13, :pitch 76} {:time 302.5, :instrument 13, :pitch 59} {:time 302.5, :instrument 13, :pitch 59} {:time 302.5, :instrument 13, :pitch 59} {:time 302.5, :instrument 13, :pitch 59} {:time 298, :instrument 13, :pitch 76} {:time 296, :instrument 13, :pitch 76} {:time 294, :instrument 13, :pitch 76} {:time 292, :instrument 13, :pitch 76} {:time 290, :instrument 13, :pitch 76} {:time 288, :instrument 13, :pitch 74} {:time 286, :instrument 13, :pitch 76} {:time 284, :instrument 13, :pitch 76} {:time 282, :instrument 13, :pitch 76} {:time 280, :instrument 13, :pitch 76} {:time 276, :instrument 13, :pitch 76} {:time 278, :instrument 13, :pitch 76} {:time 277, :instrument 13, :pitch 76} {:time 277.5, :instrument 13, :pitch 76} {:time 274, :instrument 13, :pitch 76} {:time 272, :instrument 13, :pitch 74} {:time 270, :instrument 13, :pitch 74} {:time 268, :instrument 13, :pitch 76} {:time 266, :instrument 13, :pitch 76} {:time 309, :instrument 5, :pitch 71} {:time 310, :instrument 5, :pitch 69} {:time 298, :instrument 5, :pitch 64} {:time 297, :instrument 5, :pitch 67} {:time 296, :instrument 5, :pitch 69} {:time 295, :instrument 5, :pitch 67} {:time 292, :instrument 5, :pitch 67} {:time 290, :instrument 5, :pitch 69} {:time 288, :instrument 5, :pitch 71} {:time 286, :instrument 5, :pitch 72} {:time 284, :instrument 5, :pitch 67} {:time 283, :instrument 5, :pitch 71} {:time 282.5, :instrument 5, :pitch 71} {:time 282, :instrument 5, :pitch 71} {:time 281, :instrument 5, :pitch 71} {:time 280.5, :instrument 5, :pitch 71} {:time 280, :instrument 5, :pitch 71} {:time 276, :instrument 5, :pitch 71} {:time 274, :instrument 5, :pitch 69} {:time 272, :instrument 5, :pitch 71} {:time 270, :instrument 5, :pitch 72} {:time 268, :instrument 5, :pitch 64} {:time 266.5, :instrument 5, :pitch 69} {:time 266, :instrument 5, :pitch 69} {:time 265, :instrument 5, :pitch 69} {:time 264.5, :instrument 5, :pitch 69} {:time 264, :instrument 5, :pitch 69} {:time 262, :instrument 5, :pitch 72} {:time 261, :instrument 5, :pitch 71} {:time 260, :instrument 5, :pitch 72} {:time 258, :instrument 5, :pitch 64} {:time 257, :instrument 5, :pitch 69} {:time 256.5, :instrument 5, :pitch 69} {:time 256, :instrument 5, :pitch 69} {:time 254, :instrument 5, :pitch 69} {:time 254, :instrument 5, :pitch 64} {:time 252, :instrument 5, :pitch 64} {:time 251, :instrument 5, :pitch 69} {:time 250.5, :instrument 5, :pitch 69} {:time 250, :instrument 5, :pitch 69} {:time 249, :instrument 5, :pitch 69} {:time 248.5, :instrument 5, :pitch 69} {:time 248, :instrument 5, :pitch 69} {:time 310, :instrument 8, :pitch 69} {:time 307, :instrument 8, :pitch 65} {:time 306, :instrument 8, :pitch 67} {:time 305, :instrument 8, :pitch 64} {:time 304, :instrument 8, :pitch 57} {:time 302, :instrument 8, :pitch 57} {:time 299, :instrument 8, :pitch 66} {:time 298, :instrument 8, :pitch 67} {:time 297, :instrument 8, :pitch 64} {:time 296, :instrument 8, :pitch 57} {:time 298, :instrument 5, :pitch 69} {:time 297, :instrument 5, :pitch 71} {:time 296, :instrument 5, :pitch 72} {:time 295, :instrument 5, :pitch 71} {:time 292, :instrument 5, :pitch 71} {:time 290, :instrument 5, :pitch 72} {:time 288, :instrument 5, :pitch 74} {:time 286, :instrument 5, :pitch 76} {:time 284, :instrument 5, :pitch 71} {:time 283, :instrument 5, :pitch 74} {:time 282.5, :instrument 5, :pitch 74} {:time 282, :instrument 5, :pitch 74} {:time 281, :instrument 5, :pitch 74} {:time 280.5, :instrument 5, :pitch 74} {:time 280, :instrument 5, :pitch 74} {:time 276, :instrument 5, :pitch 74} {:time 274, :instrument 5, :pitch 72} {:time 272, :instrument 5, :pitch 74} {:time 270, :instrument 5, :pitch 76} {:time 268, :instrument 5, :pitch 69} {:time 267, :instrument 5, :pitch 72} {:time 266.5, :instrument 5, :pitch 72} {:time 266, :instrument 5, :pitch 72} {:time 265, :instrument 5, :pitch 72} {:time 264.5, :instrument 5, :pitch 72} {:time 264, :instrument 5, :pitch 72} {:time 262, :instrument 5, :pitch 76} {:time 261, :instrument 5, :pitch 74} {:time 260, :instrument 5, :pitch 76} {:time 258, :instrument 5, :pitch 69} {:time 257, :instrument 5, :pitch 72} {:time 256.5, :instrument 5, :pitch 72} {:time 256, :instrument 5, :pitch 72} {:time 252, :instrument 5, :pitch 69} {:time 247, :instrument 15, :pitch 69} {:time 247, :instrument 2, :pitch 65} {:time 248, :instrument 13, :pitch 76} {:time 250, :instrument 13, :pitch 76} {:time 252, :instrument 13, :pitch 76} {:time 254, :instrument 13, :pitch 76} {:time 249, :instrument 2, :pitch 72} {:time 250, :instrument 2, :pitch 65} {:time 251, :instrument 2, :pitch 65} {:time 253, :instrument 2, :pitch 72} {:time 254, :instrument 2, :pitch 65} {:time 255, :instrument 2, :pitch 65} {:time 250, :instrument 15, :pitch 69} {:time 251, :instrument 15, :pitch 64} {:time 253, :instrument 15, :pitch 64} {:time 255, :instrument 15, :pitch 69} {:time 256, :instrument 13, :pitch 76} {:time 257, :instrument 13, :pitch 76} {:time 258, :instrument 13, :pitch 76} {:time 257, :instrument 2, :pitch 69} {:time 259, :instrument 2, :pitch 64} {:time 258, :instrument 15, :pitch 69} {:time 259, :instrument 15, :pitch 64} {:time 261, :instrument 15, :pitch 62} {:time 262, :instrument 15, :pitch 64} {:time 263, :instrument 15, :pitch 65} {:time 261, :instrument 2, :pitch 71} {:time 262, :instrument 2, :pitch 64} {:time 263, :instrument 2, :pitch 62} {:time 260, :instrument 13, :pitch 76} {:time 262, :instrument 13, :pitch 76} {:time 264, :instrument 13, :pitch 76} {:time 266, :instrument 15, :pitch 65} {:time 271, :instrument 15, :pitch 65} {:time 274, :instrument 15, :pitch 65} {:time 248, :instrument 5, :pitch 72} {:time 248.5, :instrument 5, :pitch 72} {:time 249, :instrument 5, :pitch 72} {:time 250, :instrument 5, :pitch 72} {:time 250.5, :instrument 5, :pitch 72} {:time 251, :instrument 5, :pitch 72} {:time 310, :instrument 15, :pitch 69} {:time 310, :instrument 2, :pitch 65} {:time 277, :instrument 15, :pitch 65} {:time 275, :instrument 15, :pitch 69} {:time 270, :instrument 15, :pitch 60} {:time 267, :instrument 15, :pitch 60} {:time 265, :instrument 2, :pitch 71} {:time 269, :instrument 2, :pitch 69} {:time 267, :instrument 2, :pitch 60} {:time 273, :instrument 2, :pitch 72} {:time 271, :instrument 2, :pitch 62} {:time 277, :instrument 2, :pitch 71} {:time 275, :instrument 2, :pitch 62} {:time 276, :instrument 13, :pitch 76} {:time 278, :instrument 13, :pitch 76} {:time 277, :instrument 13, :pitch 76} {:time 277.5, :instrument 13, :pitch 76} {:time 274, :instrument 13, :pitch 76} {:time 272, :instrument 13, :pitch 74} {:time 270, :instrument 13, :pitch 74} {:time 268, :instrument 13, :pitch 76} {:time 266, :instrument 13, :pitch 76} {:time 276, :instrument 5, :pitch 71} {:time 274, :instrument 5, :pitch 69} {:time 272, :instrument 5, :pitch 71} {:time 270, :instrument 5, :pitch 72} {:time 268, :instrument 5, :pitch 64} {:time 266.5, :instrument 5, :pitch 69} {:time 266, :instrument 5, :pitch 69} {:time 265, :instrument 5, :pitch 69} {:time 264.5, :instrument 5, :pitch 69} {:time 264, :instrument 5, :pitch 69} {:time 262, :instrument 5, :pitch 72} {:time 261, :instrument 5, :pitch 71} {:time 260, :instrument 5, :pitch 72} {:time 258, :instrument 5, :pitch 64} {:time 257, :instrument 5, :pitch 69} {:time 256.5, :instrument 5, :pitch 69} {:time 256, :instrument 5, :pitch 69} {:time 254, :instrument 5, :pitch 69} {:time 254, :instrument 5, :pitch 64} {:time 252, :instrument 5, :pitch 64} {:time 251, :instrument 5, :pitch 69} {:time 250.5, :instrument 5, :pitch 69} {:time 250, :instrument 5, :pitch 69} {:time 249, :instrument 5, :pitch 69} {:time 248.5, :instrument 5, :pitch 69} {:time 248, :instrument 5, :pitch 69} {:time 276, :instrument 5, :pitch 74} {:time 274, :instrument 5, :pitch 72} {:time 272, :instrument 5, :pitch 74} {:time 270, :instrument 5, :pitch 76} {:time 268, :instrument 5, :pitch 69} {:time 267, :instrument 5, :pitch 72} {:time 266.5, :instrument 5, :pitch 72} {:time 266, :instrument 5, :pitch 72} {:time 265, :instrument 5, :pitch 72} {:time 264.5, :instrument 5, :pitch 72} {:time 264, :instrument 5, :pitch 72} {:time 262, :instrument 5, :pitch 76} {:time 261, :instrument 5, :pitch 74} {:time 260, :instrument 5, :pitch 76} {:time 258, :instrument 5, :pitch 69} {:time 257, :instrument 5, :pitch 72} {:time 256.5, :instrument 5, :pitch 72} {:time 256, :instrument 5, :pitch 72} {:time 252, :instrument 5, :pitch 69} {:time 247, :instrument 15, :pitch 69} {:time 247, :instrument 2, :pitch 65} {:time 248, :instrument 13, :pitch 76} {:time 250, :instrument 13, :pitch 76} {:time 252, :instrument 13, :pitch 76} {:time 254, :instrument 13, :pitch 76} {:time 249, :instrument 2, :pitch 72} {:time 250, :instrument 2, :pitch 65} {:time 251, :instrument 2, :pitch 65} {:time 253, :instrument 2, :pitch 72} {:time 254, :instrument 2, :pitch 65} {:time 255, :instrument 2, :pitch 65} {:time 250, :instrument 15, :pitch 69} {:time 251, :instrument 15, :pitch 64} {:time 253, :instrument 15, :pitch 64} {:time 255, :instrument 15, :pitch 69} {:time 256, :instrument 13, :pitch 76} {:time 257, :instrument 13, :pitch 76} {:time 258, :instrument 13, :pitch 76} {:time 257, :instrument 2, :pitch 69} {:time 259, :instrument 2, :pitch 64} {:time 258, :instrument 15, :pitch 69} {:time 259, :instrument 15, :pitch 64} {:time 261, :instrument 15, :pitch 62} {:time 262, :instrument 15, :pitch 64} {:time 263, :instrument 15, :pitch 65} {:time 261, :instrument 2, :pitch 71} {:time 262, :instrument 2, :pitch 64} {:time 263, :instrument 2, :pitch 62} {:time 260, :instrument 13, :pitch 76} {:time 262, :instrument 13, :pitch 76} {:time 264, :instrument 13, :pitch 76} {:time 266, :instrument 15, :pitch 65} {:time 271, :instrument 15, :pitch 65} {:time 274, :instrument 15, :pitch 65} {:time 248, :instrument 5, :pitch 72} {:time 248.5, :instrument 5, :pitch 72} {:time 249, :instrument 5, :pitch 72} {:time 250, :instrument 5, :pitch 72} {:time 250.5, :instrument 5, :pitch 72} {:time 251, :instrument 5, :pitch 72} {:time 247, :instrument 8, :pitch 69} {:time 246, :instrument 8, :pitch 67} {:time 242, :instrument 3, :pitch 65} {:time 238.5, :instrument 2, :pitch 79} {:time 241, :instrument 2, :pitch 67} {:time 240.5, :instrument 2, :pitch 69} {:time 242, :instrument 2, :pitch 59} {:time 239.5, :instrument 2, :pitch 74} {:time 241.5, :instrument 2, :pitch 67} {:time 240, :instrument 2, :pitch 72} {:time 239, :instrument 2, :pitch 76} {:time 237.5, :instrument 2, :pitch 76} {:time 236.5, :instrument 12, :pitch 69} {:time 235.5, :instrument 12, :pitch 76} {:time 234.5, :instrument 12, :pitch 74} {:time 233.5, :instrument 12, :pitch 71} {:time 233, :instrument 12, :pitch 67} {:time 232.5, :instrument 12, :pitch 64} {:time 228.5, :instrument 12, :pitch 71} {:time 227.5, :instrument 12, :pitch 76} {:time 226.5, :instrument 12, :pitch 74} {:time 225.5, :instrument 12, :pitch 72} {:time 225, :instrument 12, :pitch 67} {:time 224.5, :instrument 12, :pitch 64} {:time 222.5, :instrument 12, :pitch 72} {:time 222, :instrument 12, :pitch 59} {:time 220.5, :instrument 12, :pitch 77} {:time 218.5, :instrument 12, :pitch 76} {:time 216.5, :instrument 12, :pitch 77} {:time 213.5, :instrument 12, :pitch 79} {:time 212.5, :instrument 12, :pitch 74} {:time 210.5, :instrument 12, :pitch 76} {:time 210, :instrument 12, :pitch 72} {:time 209.5, :instrument 12, :pitch 69} {:time 206, :instrument 12, :pitch 76} {:time 204, :instrument 12, :pitch 77} {:time 202, :instrument 12, :pitch 76} {:time 200, :instrument 12, :pitch 77} {:time 198, :instrument 12, :pitch 79} {:time 197, :instrument 12, :pitch 74} {:time 195, :instrument 12, :pitch 76} {:time 194.5, :instrument 12, :pitch 72} {:time 194, :instrument 12, :pitch 69} {:time 191, :instrument 12, :pitch 76} {:time 190.5, :instrument 12, :pitch 72} {:time 190, :instrument 12, :pitch 69} {:time 237.5, :instrument 15, :pitch 69} {:time 235.5, :instrument 15, :pitch 67} {:time 233.5, :instrument 15, :pitch 62} {:time 232.5, :instrument 15, :pitch 67} {:time 229.5, :instrument 15, :pitch 67} {:time 228.5, :instrument 15, :pitch 62} {:time 225.5, :instrument 15, :pitch 62} {:time 224.5, :instrument 15, :pitch 67} {:time 221.5, :instrument 15, :pitch 67} {:time 219.5, :instrument 15, :pitch 65} {:time 217.5, :instrument 15, :pitch 60} {:time 216.5, :instrument 15, :pitch 65} {:time 213.5, :instrument 15, :pitch 65} {:time 212.5, :instrument 15, :pitch 60} {:time 209.5, :instrument 15, :pitch 60} {:time 208.5, :instrument 15, :pitch 65} {:time 206, :instrument 15, :pitch 65} {:time 205, :instrument 15, :pitch 67} {:time 204, :instrument 15, :pitch 69} {:time 203, :instrument 15, :pitch 64} {:time 202, :instrument 15, :pitch 69} {:time 199, :instrument 15, :pitch 69} {:time 198, :instrument 15, :pitch 64} {:time 195, :instrument 15, :pitch 64} {:time 194, :instrument 15, :pitch 69} {:time 191, :instrument 2, :pitch 62} {:time 191, :instrument 15, :pitch 69} {:time 187, :instrument 14, :pitch 76} {:time 183, :instrument 2, :pitch 62} {:time 175, :instrument 2, :pitch 60} {:time 167, :instrument 2, :pitch 62} {:time 161, :instrument 2, :pitch 76} {:time 163, :instrument 2, :pitch 62} {:time 186, :instrument 14, :pitch 72} {:time 185, :instrument 14, :pitch 68} {:time 184, :instrument 14, :pitch 68} {:time 182, :instrument 14, :pitch 68} {:time 181, :instrument 14, :pitch 67} {:time 180, :instrument 14, :pitch 64} {:time 179, :instrument 14, :pitch 67} {:time 175, :instrument 14, :pitch 67} {:time 172, :instrument 14, :pitch 69} {:time 170, :instrument 14, :pitch 67} {:time 168, :instrument 14, :pitch 69} {:time 166, :instrument 14, :pitch 72} {:time 165, :instrument 14, :pitch 67} {:time 163, :instrument 14, :pitch 69} {:time 159, :instrument 14, :pitch 69} {:time 154, :instrument 14, :pitch 60} {:time 153, :instrument 14, :pitch 64} {:time 152, :instrument 14, :pitch 65} {:time 151, :instrument 14, :pitch 64} {:time 148, :instrument 14, :pitch 69} {:time 147, :instrument 14, :pitch 67} {:time 143, :instrument 14, :pitch 67} {:time 140, :instrument 14, :pitch 69} {:time 138, :instrument 14, :pitch 67} {:time 136, :instrument 14, :pitch 69} {:time 134, :instrument 14, :pitch 72} {:time 133, :instrument 14, :pitch 67} {:time 131, :instrument 14, :pitch 69} {:time 126, :instrument 14, :pitch 69} {:time 125, :instrument 14, :pitch 67} {:time 159, :instrument 2, :pitch 63} {:time 158, :instrument 2, :pitch 73} {:time 157, :instrument 2, :pitch 68} {:time 156, :instrument 2, :pitch 70} {:time 155, :instrument 2, :pitch 72} {:time 151, :instrument 2, :pitch 66} {:time 147, :instrument 2, :pitch 75} {:time 143, :instrument 2, :pitch 63} {:time 139, :instrument 2, :pitch 75} {:time 138, :instrument 2, :pitch 66} {:time 135, :instrument 2, :pitch 65} {:time 131.5, :instrument 2, :pitch 75} {:time 129.5, :instrument 2, :pitch 63} {:time 127, :instrument 2, :pitch 61} {:time 186.5, :instrument 13, :pitch 76} {:time 186, :instrument 13, :pitch 76} {:time 184.5, :instrument 13, :pitch 76} {:time 184, :instrument 13, :pitch 76} {:time 182.5, :instrument 13, :pitch 76} {:time 182, :instrument 13, :pitch 76} {:time 180.5, :instrument 13, :pitch 76} {:time 180, :instrument 13, :pitch 76} {:time 178.5, :instrument 13, :pitch 76} {:time 178, :instrument 13, :pitch 76} {:time 176.5, :instrument 13, :pitch 76} {:time 176, :instrument 13, :pitch 76} {:time 174.5, :instrument 13, :pitch 76} {:time 174, :instrument 13, :pitch 76} {:time 172.5, :instrument 13, :pitch 76} {:time 172, :instrument 13, :pitch 76} {:time 170.5, :instrument 13, :pitch 76} {:time 170, :instrument 13, :pitch 76} {:time 168.5, :instrument 13, :pitch 76} {:time 168, :instrument 13, :pitch 76} {:time 166.5, :instrument 13, :pitch 76} {:time 166, :instrument 13, :pitch 76} {:time 164.5, :instrument 13, :pitch 76} {:time 164, :instrument 13, :pitch 76} {:time 162.5, :instrument 13, :pitch 76} {:time 162, :instrument 13, :pitch 76} {:time 160.5, :instrument 13, :pitch 76} {:time 160, :instrument 13, :pitch 76} {:time 158.5, :instrument 13, :pitch 76} {:time 158, :instrument 13, :pitch 76} {:time 156.5, :instrument 13, :pitch 76} {:time 156, :instrument 13, :pitch 76} {:time 154.5, :instrument 13, :pitch 76} {:time 154, :instrument 13, :pitch 76} {:time 152.5, :instrument 13, :pitch 76} {:time 152, :instrument 13, :pitch 76} {:time 150.5, :instrument 13, :pitch 76} {:time 150, :instrument 13, :pitch 76} {:time 148.5, :instrument 13, :pitch 76} {:time 148, :instrument 13, :pitch 76} {:time 146.5, :instrument 13, :pitch 76} {:time 146, :instrument 13, :pitch 76} {:time 144.5, :instrument 13, :pitch 76} {:time 144, :instrument 13, :pitch 76} {:time 142.5, :instrument 13, :pitch 76} {:time 142, :instrument 13, :pitch 76} {:time 140.5, :instrument 13, :pitch 76} {:time 140, :instrument 13, :pitch 76} {:time 138.5, :instrument 13, :pitch 76} {:time 138, :instrument 13, :pitch 76} {:time 136.5, :instrument 13, :pitch 76} {:time 136, :instrument 13, :pitch 76} {:time 134.5, :instrument 13, :pitch 76} {:time 134, :instrument 13, :pitch 76} {:time 132.5, :instrument 13, :pitch 76} {:time 132, :instrument 13, :pitch 76} {:time 130.5, :instrument 13, :pitch 76} {:time 130, :instrument 13, :pitch 76} {:time 128.5, :instrument 13, :pitch 76} {:time 128, :instrument 13, :pitch 76} {:time 62, :instrument 3, :pitch 64} {:time 60, :instrument 15, :pitch 64} {:time 59, :instrument 15, :pitch 69} {:time 56, :instrument 15, :pitch 69} {:time 55, :instrument 15, :pitch 71} {:time 54, :instrument 15, :pitch 72} {:time 52, :instrument 15, :pitch 64} {:time 51, :instrument 15, :pitch 69} {:time 48, :instrument 15, :pitch 69} {:time 46, :instrument 15, :pitch 67} {:time 44, :instrument 15, :pitch 62} {:time 43, :instrument 15, :pitch 67} {:time 40, :instrument 15, :pitch 67} {:time 39, :instrument 15, :pitch 62} {:time 36, :instrument 15, :pitch 62} {:time 35, :instrument 15, :pitch 67} {:time 32, :instrument 15, :pitch 67} {:time 30, :instrument 15, :pitch 65} {:time 28, :instrument 15, :pitch 69} {:time 23, :instrument 15, :pitch 60} {:time 20, :instrument 15, :pitch 60} {:time 18, :instrument 2, :pitch 71} {:time 22, :instrument 2, :pitch 69} {:time 20, :instrument 2, :pitch 60} {:time 26, :instrument 2, :pitch 72} {:time 24, :instrument 2, :pitch 62} {:time 30, :instrument 2, :pitch 71} {:time 28, :instrument 2, :pitch 62} {:time 34, :instrument 2, :pitch 72} {:time 32, :instrument 2, :pitch 62} {:time 34.5, :instrument 2, :pitch 74} {:time 36, :instrument 2, :pitch 64} {:time 38, :instrument 2, :pitch 74} {:time 42, :instrument 2, :pitch 69} {:time 40, :instrument 2, :pitch 64} {:time 44, :instrument 2, :pitch 60} {:time 48, :instrument 2, :pitch 62} {:time 54, :instrument 2, :pitch 71} {:time 52, :instrument 2, :pitch 62} {:time 58, :instrument 2, :pitch 71} {:time 56, :instrument 2, :pitch 60} {:time 62, :instrument 2, :pitch 71} {:time 60, :instrument 2, :pitch 62} {:time 63, :instrument 13, :pitch 76} {:time 61, :instrument 13, :pitch 76} {:time 59, :instrument 13, :pitch 76} {:time 57, :instrument 13, :pitch 76} {:time 55, :instrument 13, :pitch 76} {:time 53, :instrument 13, :pitch 76} {:time 55.5, :instrument 13, :pitch 59} {:time 55.5, :instrument 13, :pitch 59} {:time 55.5, :instrument 13, :pitch 59} {:time 55.5, :instrument 13, :pitch 59} {:time 51, :instrument 13, :pitch 76} {:time 49, :instrument 13, :pitch 76} {:time 47, :instrument 13, :pitch 76} {:time 45, :instrument 13, :pitch 76} {:time 43, :instrument 13, :pitch 76} {:time 41, :instrument 13, :pitch 74} {:time 39, :instrument 13, :pitch 76} {:time 37, :instrument 13, :pitch 76} {:time 35, :instrument 13, :pitch 76} {:time 33, :instrument 13, :pitch 76} {:time 29, :instrument 13, :pitch 76} {:time 31, :instrument 13, :pitch 76} {:time 30, :instrument 13, :pitch 76} {:time 30.5, :instrument 13, :pitch 76} {:time 27, :instrument 13, :pitch 76} {:time 25, :instrument 13, :pitch 74} {:time 23, :instrument 13, :pitch 74} {:time 21, :instrument 13, :pitch 76} {:time 19, :instrument 13, :pitch 76} {:time 62, :instrument 5, :pitch 71} {:time 63, :instrument 5, :pitch 69} {:time 51, :instrument 5, :pitch 64} {:time 50, :instrument 5, :pitch 67} {:time 49, :instrument 5, :pitch 69} {:time 48, :instrument 5, :pitch 67} {:time 45, :instrument 5, :pitch 67} {:time 43, :instrument 5, :pitch 69} {:time 41, :instrument 5, :pitch 71} {:time 39, :instrument 5, :pitch 72} {:time 37, :instrument 5, :pitch 67} {:time 36, :instrument 5, :pitch 71} {:time 35.5, :instrument 5, :pitch 71} {:time 35, :instrument 5, :pitch 71} {:time 34, :instrument 5, :pitch 71} {:time 33.5, :instrument 5, :pitch 71} {:time 33, :instrument 5, :pitch 71} {:time 29, :instrument 5, :pitch 71} {:time 27, :instrument 5, :pitch 69} {:time 25, :instrument 5, :pitch 71} {:time 23, :instrument 5, :pitch 72} {:time 21, :instrument 5, :pitch 64} {:time 19.5, :instrument 5, :pitch 69} {:time 19, :instrument 5, :pitch 69} {:time 18, :instrument 5, :pitch 69} {:time 17.5, :instrument 5, :pitch 69} {:time 17, :instrument 5, :pitch 69} {:time 15, :instrument 5, :pitch 72} {:time 14, :instrument 5, :pitch 71} {:time 13, :instrument 5, :pitch 72} {:time 11, :instrument 5, :pitch 64} {:time 10, :instrument 5, :pitch 69} {:time 9.5, :instrument 5, :pitch 69} {:time 9, :instrument 5, :pitch 69} {:time 7, :instrument 5, :pitch 69} {:time 7, :instrument 5, :pitch 64} {:time 5, :instrument 5, :pitch 64} {:time 4, :instrument 5, :pitch 69} {:time 3.5, :instrument 5, :pitch 69} {:time 3, :instrument 5, :pitch 69} {:time 2, :instrument 5, :pitch 69} {:time 1.5, :instrument 5, :pitch 69} {:time 1, :instrument 5, :pitch 69} {:time 63, :instrument 8, :pitch 69} {:time 60, :instrument 8, :pitch 65} {:time 59, :instrument 8, :pitch 67} {:time 58, :instrument 8, :pitch 64} {:time 57, :instrument 8, :pitch 57} {:time 55, :instrument 8, :pitch 57} {:time 52, :instrument 8, :pitch 66} {:time 51, :instrument 8, :pitch 67} {:time 50, :instrument 8, :pitch 64} {:time 49, :instrument 8, :pitch 57} {:time 51, :instrument 5, :pitch 69} {:time 50, :instrument 5, :pitch 71} {:time 49, :instrument 5, :pitch 72} {:time 48, :instrument 5, :pitch 71} {:time 45, :instrument 5, :pitch 71} {:time 43, :instrument 5, :pitch 72} {:time 41, :instrument 5, :pitch 74} {:time 39, :instrument 5, :pitch 76} {:time 37, :instrument 5, :pitch 71} {:time 36, :instrument 5, :pitch 74} {:time 35.5, :instrument 5, :pitch 74} {:time 35, :instrument 5, :pitch 74} {:time 34, :instrument 5, :pitch 74} {:time 33.5, :instrument 5, :pitch 74} {:time 33, :instrument 5, :pitch 74} {:time 29, :instrument 5, :pitch 74} {:time 27, :instrument 5, :pitch 72} {:time 25, :instrument 5, :pitch 74} {:time 23, :instrument 5, :pitch 76} {:time 21, :instrument 5, :pitch 69} {:time 20, :instrument 5, :pitch 72} {:time 19.5, :instrument 5, :pitch 72} {:time 19, :instrument 5, :pitch 72} {:time 18, :instrument 5, :pitch 72} {:time 17.5, :instrument 5, :pitch 72} {:time 17, :instrument 5, :pitch 72} {:time 15, :instrument 5, :pitch 76} {:time 14, :instrument 5, :pitch 74} {:time 13, :instrument 5, :pitch 76} {:time 11, :instrument 5, :pitch 69} {:time 10, :instrument 5, :pitch 72} {:time 9.5, :instrument 5, :pitch 72} {:time 9, :instrument 5, :pitch 72} {:time 5, :instrument 5, :pitch 69} {:time 0, :instrument 15, :pitch 69} {:time 0, :instrument 2, :pitch 65} {:time 1, :instrument 13, :pitch 76} {:time 3, :instrument 13, :pitch 76} {:time 5, :instrument 13, :pitch 76} {:time 7, :instrument 13, :pitch 76} {:time 2, :instrument 2, :pitch 72} {:time 3, :instrument 2, :pitch 65} {:time 4, :instrument 2, :pitch 65} {:time 6, :instrument 2, :pitch 72} {:time 7, :instrument 2, :pitch 65} {:time 8, :instrument 2, :pitch 65} {:time 3, :instrument 15, :pitch 69} {:time 4, :instrument 15, :pitch 64} {:time 6, :instrument 15, :pitch 64} {:time 8, :instrument 15, :pitch 69} {:time 9, :instrument 13, :pitch 76} {:time 10, :instrument 13, :pitch 76} {:time 11, :instrument 13, :pitch 76} {:time 10, :instrument 2, :pitch 69} {:time 12, :instrument 2, :pitch 64} {:time 11, :instrument 15, :pitch 69} {:time 12, :instrument 15, :pitch 64} {:time 14, :instrument 15, :pitch 62} {:time 15, :instrument 15, :pitch 64} {:time 16, :instrument 15, :pitch 65} {:time 14, :instrument 2, :pitch 71} {:time 15, :instrument 2, :pitch 64} {:time 16, :instrument 2, :pitch 62} {:time 13, :instrument 13, :pitch 76} {:time 15, :instrument 13, :pitch 76} {:time 17, :instrument 13, :pitch 76} {:time 19, :instrument 15, :pitch 65} {:time 24, :instrument 15, :pitch 65} {:time 27, :instrument 15, :pitch 65} {:time 1, :instrument 5, :pitch 72} {:time 1.5, :instrument 5, :pitch 72} {:time 2, :instrument 5, :pitch 72} {:time 3, :instrument 5, :pitch 72} {:time 3.5, :instrument 5, :pitch 72} {:time 4, :instrument 5, :pitch 72} {:time 125, :instrument 3, :pitch 64} {:time 123, :instrument 15, :pitch 64} {:time 122, :instrument 15, :pitch 69} {:time 119, :instrument 15, :pitch 69} {:time 118, :instrument 15, :pitch 71} {:time 117, :instrument 15, :pitch 72} {:time 115, :instrument 15, :pitch 64} {:time 114, :instrument 15, :pitch 69} {:time 111, :instrument 15, :pitch 69} {:time 109, :instrument 15, :pitch 67} {:time 107, :instrument 15, :pitch 62} {:time 106, :instrument 15, :pitch 67} {:time 103, :instrument 15, :pitch 67} {:time 102, :instrument 15, :pitch 62} {:time 99, :instrument 15, :pitch 62} {:time 98, :instrument 15, :pitch 67} {:time 95, :instrument 15, :pitch 67} {:time 93, :instrument 15, :pitch 65} {:time 91, :instrument 15, :pitch 69} {:time 86, :instrument 15, :pitch 60} {:time 83, :instrument 15, :pitch 60} {:time 81, :instrument 2, :pitch 71} {:time 85, :instrument 2, :pitch 69} {:time 83, :instrument 2, :pitch 60} {:time 89, :instrument 2, :pitch 72} {:time 87, :instrument 2, :pitch 62} {:time 93, :instrument 2, :pitch 71} {:time 91, :instrument 2, :pitch 62} {:time 97, :instrument 2, :pitch 72} {:time 95, :instrument 2, :pitch 62} {:time 97.5, :instrument 2, :pitch 74} {:time 99, :instrument 2, :pitch 64} {:time 101, :instrument 2, :pitch 74} {:time 105, :instrument 2, :pitch 69} {:time 103, :instrument 2, :pitch 64} {:time 107, :instrument 2, :pitch 60} {:time 111, :instrument 2, :pitch 62} {:time 117, :instrument 2, :pitch 71} {:time 115, :instrument 2, :pitch 62} {:time 121, :instrument 2, :pitch 71} {:time 119, :instrument 2, :pitch 60} {:time 123, :instrument 2, :pitch 62} {:time 126, :instrument 13, :pitch 76} {:time 124, :instrument 13, :pitch 76} {:time 122, :instrument 13, :pitch 76} {:time 120, :instrument 13, :pitch 76} {:time 118, :instrument 13, :pitch 76} {:time 116, :instrument 13, :pitch 76} {:time 118.5, :instrument 13, :pitch 59} {:time 118.5, :instrument 13, :pitch 59} {:time 118.5, :instrument 13, :pitch 59} {:time 118.5, :instrument 13, :pitch 59} {:time 114, :instrument 13, :pitch 76} {:time 112, :instrument 13, :pitch 76} {:time 110, :instrument 13, :pitch 76} {:time 108, :instrument 13, :pitch 76} {:time 106, :instrument 13, :pitch 76} {:time 104, :instrument 13, :pitch 74} {:time 102, :instrument 13, :pitch 76} {:time 100, :instrument 13, :pitch 76} {:time 98, :instrument 13, :pitch 76} {:time 96, :instrument 13, :pitch 76} {:time 92, :instrument 13, :pitch 76} {:time 94, :instrument 13, :pitch 76} {:time 93, :instrument 13, :pitch 76} {:time 93.5, :instrument 13, :pitch 76} {:time 90, :instrument 13, :pitch 76} {:time 88, :instrument 13, :pitch 74} {:time 86, :instrument 13, :pitch 74} {:time 84, :instrument 13, :pitch 76} {:time 82, :instrument 13, :pitch 76} {:time 114, :instrument 5, :pitch 64} {:time 113, :instrument 5, :pitch 67} {:time 112, :instrument 5, :pitch 69} {:time 111, :instrument 5, :pitch 67} {:time 108, :instrument 5, :pitch 67} {:time 106, :instrument 5, :pitch 69} {:time 104, :instrument 5, :pitch 71} {:time 102, :instrument 5, :pitch 72} {:time 100, :instrument 5, :pitch 67} {:time 99, :instrument 5, :pitch 71} {:time 98.5, :instrument 5, :pitch 71} {:time 98, :instrument 5, :pitch 71} {:time 97, :instrument 5, :pitch 71} {:time 96.5, :instrument 5, :pitch 71} {:time 96, :instrument 5, :pitch 71} {:time 92, :instrument 5, :pitch 71} {:time 90, :instrument 5, :pitch 69} {:time 88, :instrument 5, :pitch 71} {:time 86, :instrument 5, :pitch 72} {:time 84, :instrument 5, :pitch 64} {:time 82.5, :instrument 5, :pitch 69} {:time 82, :instrument 5, :pitch 69} {:time 81, :instrument 5, :pitch 69} {:time 80.5, :instrument 5, :pitch 69} {:time 80, :instrument 5, :pitch 69} {:time 78, :instrument 5, :pitch 72} {:time 77, :instrument 5, :pitch 71} {:time 76, :instrument 5, :pitch 72} {:time 74, :instrument 5, :pitch 64} {:time 73, :instrument 5, :pitch 69} {:time 72.5, :instrument 5, :pitch 69} {:time 72, :instrument 5, :pitch 69} {:time 70, :instrument 5, :pitch 69} {:time 70, :instrument 5, :pitch 64} {:time 68, :instrument 5, :pitch 64} {:time 67, :instrument 5, :pitch 69} {:time 66.5, :instrument 5, :pitch 69} {:time 66, :instrument 5, :pitch 69} {:time 65, :instrument 5, :pitch 69} {:time 64.5, :instrument 5, :pitch 69} {:time 64, :instrument 5, :pitch 69} {:time 123, :instrument 8, :pitch 65} {:time 122, :instrument 8, :pitch 67} {:time 121, :instrument 8, :pitch 64} {:time 120, :instrument 8, :pitch 57} {:time 118, :instrument 8, :pitch 57} {:time 115, :instrument 8, :pitch 66} {:time 114, :instrument 8, :pitch 67} {:time 113, :instrument 8, :pitch 64} {:time 112, :instrument 8, :pitch 57} {:time 114, :instrument 5, :pitch 69} {:time 113, :instrument 5, :pitch 71} {:time 112, :instrument 5, :pitch 72} {:time 111, :instrument 5, :pitch 71} {:time 108, :instrument 5, :pitch 71} {:time 106, :instrument 5, :pitch 72} {:time 104, :instrument 5, :pitch 74} {:time 102, :instrument 5, :pitch 76} {:time 100, :instrument 5, :pitch 71} {:time 99, :instrument 5, :pitch 74} {:time 98.5, :instrument 5, :pitch 74} {:time 98, :instrument 5, :pitch 74} {:time 97, :instrument 5, :pitch 74} {:time 96.5, :instrument 5, :pitch 74} {:time 96, :instrument 5, :pitch 74} {:time 92, :instrument 5, :pitch 74} {:time 90, :instrument 5, :pitch 72} {:time 88, :instrument 5, :pitch 74} {:time 86, :instrument 5, :pitch 76} {:time 84, :instrument 5, :pitch 69} {:time 83, :instrument 5, :pitch 72} {:time 82.5, :instrument 5, :pitch 72} {:time 82, :instrument 5, :pitch 72} {:time 81, :instrument 5, :pitch 72} {:time 80.5, :instrument 5, :pitch 72} {:time 80, :instrument 5, :pitch 72} {:time 78, :instrument 5, :pitch 76} {:time 77, :instrument 5, :pitch 74} {:time 76, :instrument 5, :pitch 76} {:time 74, :instrument 5, :pitch 69} {:time 73, :instrument 5, :pitch 72} {:time 72.5, :instrument 5, :pitch 72} {:time 72, :instrument 5, :pitch 72} {:time 68, :instrument 5, :pitch 69} {:time 63, :instrument 15, :pitch 69} {:time 63, :instrument 2, :pitch 65} {:time 64, :instrument 13, :pitch 76} {:time 66, :instrument 13, :pitch 76} {:time 68, :instrument 13, :pitch 76} {:time 70, :instrument 13, :pitch 76} {:time 65, :instrument 2, :pitch 72} {:time 66, :instrument 2, :pitch 65} {:time 67, :instrument 2, :pitch 65} {:time 69, :instrument 2, :pitch 72} {:time 70, :instrument 2, :pitch 65} {:time 71, :instrument 2, :pitch 65} {:time 66, :instrument 15, :pitch 69} {:time 67, :instrument 15, :pitch 64} {:time 69, :instrument 15, :pitch 64} {:time 71, :instrument 15, :pitch 69} {:time 72, :instrument 13, :pitch 76} {:time 73, :instrument 13, :pitch 76} {:time 74, :instrument 13, :pitch 76} {:time 73, :instrument 2, :pitch 69} {:time 75, :instrument 2, :pitch 64} {:time 74, :instrument 15, :pitch 69} {:time 75, :instrument 15, :pitch 64} {:time 77, :instrument 15, :pitch 62} {:time 78, :instrument 15, :pitch 64} {:time 79, :instrument 15, :pitch 65} {:time 77, :instrument 2, :pitch 71} {:time 78, :instrument 2, :pitch 64} {:time 79, :instrument 2, :pitch 62} {:time 76, :instrument 13, :pitch 76} {:time 78, :instrument 13, :pitch 76} {:time 80, :instrument 13, :pitch 76} {:time 82, :instrument 15, :pitch 65} {:time 87, :instrument 15, :pitch 65} {:time 90, :instrument 15, :pitch 65} {:time 64, :instrument 5, :pitch 72} {:time 64.5, :instrument 5, :pitch 72} {:time 65, :instrument 5, :pitch 72} {:time 66, :instrument 5, :pitch 72} {:time 66.5, :instrument 5, :pitch 72} {:time 67, :instrument 5, :pitch 72} {:time 127, :instrument 15, :pitch 70} {:time 128, :instrument 15, :pitch 70} {:time 128.5, :instrument 15, :pitch 70} {:time 129, :instrument 15, :pitch 70} {:time 130, :instrument 15, :pitch 70} {:time 130.5, :instrument 15, :pitch 70} {:time 131, :instrument 15, :pitch 70} {:time 132, :instrument 15, :pitch 77} {:time 133, :instrument 15, :pitch 74} {:time 136, :instrument 15, :pitch 70} {:time 137, :instrument 15, :pitch 74} {:time 138, :instrument 15, :pitch 70} {:time 139, :instrument 15, :pitch 77} {:time 140, :instrument 15, :pitch 74} {:time 141, :instrument 15, :pitch 70} {:time 142, :instrument 15, :pitch 74} {:time 143, :instrument 15, :pitch 69} {:time 145, :instrument 15, :pitch 69} {:time 146, :instrument 15, :pitch 69} {:time 146.5, :instrument 15, :pitch 69} {:time 147, :instrument 15, :pitch 69} {:time 148, :instrument 15, :pitch 76} {:time 149, :instrument 15, :pitch 72} {:time 150, :instrument 15, :pitch 79} {:time 152, :instrument 15, :pitch 69} {:time 153, :instrument 15, :pitch 76} {:time 154, :instrument 15, :pitch 72} {:time 155, :instrument 15, :pitch 79} {:time 156, :instrument 15, :pitch 76} {:time 157, :instrument 15, :pitch 72} {:time 158, :instrument 15, :pitch 69} {:time 159, :instrument 15, :pitch 70} {:time 160, :instrument 15, :pitch 70} {:time 160.5, :instrument 15, :pitch 70} {:time 161, :instrument 15, :pitch 70} {:time 162, :instrument 15, :pitch 70} {:time 162.5, :instrument 15, :pitch 70} {:time 163, :instrument 15, :pitch 70} {:time 164, :instrument 15, :pitch 77} {:time 165, :instrument 15, :pitch 74} {:time 166, :instrument 15, :pitch 74} {:time 168, :instrument 15, :pitch 70} {:time 169, :instrument 15, :pitch 74} {:time 170, :instrument 15, :pitch 70} {:time 171, :instrument 15, :pitch 77} {:time 172, :instrument 15, :pitch 74} {:time 173, :instrument 15, :pitch 70} {:time 174, :instrument 15, :pitch 74} {:time 175, :instrument 15, :pitch 67} {:time 177, :instrument 15, :pitch 67} {:time 178, :instrument 15, :pitch 67} {:time 178.5, :instrument 15, :pitch 67} {:time 179, :instrument 15, :pitch 67} {:time 180, :instrument 15, :pitch 64} {:time 181, :instrument 15, :pitch 67} {:time 182, :instrument 15, :pitch 68} {:time 184, :instrument 15, :pitch 68} {:time 185, :instrument 15, :pitch 68} {:time 186, :instrument 15, :pitch 71}]
          )))

(reg-event-db
 :load-zelda
 (fn [db [_ notes]]
   (dispatch [:set-tempo 360])
   (assoc db :notes
[{:time 240, :instrument 15, :pitch 73} {:time 239.5, :instrument 15, :pitch 70} {:time 239, :instrument 15, :pitch 67} {:time 238, :instrument 15, :pitch 67} {:time 237.5, :instrument 15, :pitch 67} {:time 237, :instrument 15, :pitch 67} {:time 236, :instrument 15, :pitch 67} {:time 235.5, :instrument 15, :pitch 67} {:time 235, :instrument 15, :pitch 67} {:time 234, :instrument 15, :pitch 67} {:time 233.5, :instrument 15, :pitch 67} {:time 233, :instrument 15, :pitch 67} {:time 232, :instrument 15, :pitch 67} {:time 231.5, :instrument 15, :pitch 65} {:time 231, :instrument 15, :pitch 65} {:time 230, :instrument 15, :pitch 65} {:time 229.5, :instrument 15, :pitch 65} {:time 229, :instrument 15, :pitch 65} {:time 228, :instrument 15, :pitch 65} {:time 227.5, :instrument 15, :pitch 65} {:time 227, :instrument 15, :pitch 65} {:time 226, :instrument 15, :pitch 65} {:time 225.5, :instrument 15, :pitch 65} {:time 225, :instrument 15, :pitch 65} {:time 224, :instrument 15, :pitch 65} {:time 223.5, :instrument 15, :pitch 66} {:time 223, :instrument 15, :pitch 66} {:time 222, :instrument 15, :pitch 66} {:time 221.5, :instrument 15, :pitch 66} {:time 221, :instrument 15, :pitch 66} {:time 220, :instrument 15, :pitch 66} {:time 219.5, :instrument 15, :pitch 66} {:time 219, :instrument 15, :pitch 66} {:time 218, :instrument 15, :pitch 66} {:time 217.5, :instrument 15, :pitch 66} {:time 217, :instrument 15, :pitch 66} {:time 216, :instrument 15, :pitch 66} {:time 215.5, :instrument 15, :pitch 67} {:time 215, :instrument 15, :pitch 67} {:time 214, :instrument 15, :pitch 67} {:time 213.5, :instrument 15, :pitch 67} {:time 213, :instrument 15, :pitch 67} {:time 212, :instrument 15, :pitch 67} {:time 211.5, :instrument 15, :pitch 67} {:time 211, :instrument 15, :pitch 67} {:time 210, :instrument 15, :pitch 67} {:time 209.5, :instrument 15, :pitch 67} {:time 209, :instrument 15, :pitch 67} {:time 208, :instrument 15, :pitch 67} {:time 207.5, :instrument 15, :pitch 59} {:time 207, :instrument 15, :pitch 59} {:time 206, :instrument 15, :pitch 59} {:time 205.5, :instrument 15, :pitch 59} {:time 205, :instrument 15, :pitch 59} {:time 204, :instrument 15, :pitch 59} {:time 203.5, :instrument 15, :pitch 59} {:time 203, :instrument 15, :pitch 59} {:time 202, :instrument 15, :pitch 59} {:time 201.5, :instrument 15, :pitch 59} {:time 201, :instrument 15, :pitch 59} {:time 200, :instrument 15, :pitch 59} {:time 199.5, :instrument 15, :pitch 58} {:time 199, :instrument 15, :pitch 58} {:time 198, :instrument 15, :pitch 58} {:time 197.5, :instrument 15, :pitch 58} {:time 197, :instrument 15, :pitch 58} {:time 196, :instrument 15, :pitch 58} {:time 195.5, :instrument 15, :pitch 58} {:time 195, :instrument 15, :pitch 58} {:time 194, :instrument 15, :pitch 58} {:time 193.5, :instrument 15, :pitch 58} {:time 193, :instrument 15, :pitch 58} {:time 192, :instrument 15, :pitch 58} {:time 191.5, :instrument 15, :pitch 59} {:time 191, :instrument 15, :pitch 59} {:time 192, :instrument 2, :pitch 55} {:time 191.5, :instrument 2, :pitch 57} {:time 191, :instrument 2, :pitch 57} {:time 190, :instrument 2, :pitch 55} {:time 189.5, :instrument 2, :pitch 55} {:time 189, :instrument 2, :pitch 55} {:time 188, :instrument 2, :pitch 55} {:time 187.5, :instrument 2, :pitch 55} {:time 187, :instrument 2, :pitch 57} {:time 186, :instrument 2, :pitch 55} {:time 185.5, :instrument 2, :pitch 55} {:time 185, :instrument 2, :pitch 55} {:time 190, :instrument 15, :pitch 59} {:time 189.5, :instrument 15, :pitch 59} {:time 189, :instrument 15, :pitch 59} {:time 188, :instrument 15, :pitch 59} {:time 187.5, :instrument 15, :pitch 59} {:time 187, :instrument 15, :pitch 59} {:time 186, :instrument 15, :pitch 59} {:time 185.5, :instrument 15, :pitch 59} {:time 185, :instrument 15, :pitch 59} {:time 183.5, :instrument 15, :pitch 58} {:time 183, :instrument 15, :pitch 58} {:time 182, :instrument 15, :pitch 58} {:time 181.5, :instrument 15, :pitch 58} {:time 181, :instrument 15, :pitch 58} {:time 180, :instrument 15, :pitch 58} {:time 179.5, :instrument 15, :pitch 58} {:time 179, :instrument 15, :pitch 58} {:time 178, :instrument 15, :pitch 58} {:time 177.5, :instrument 15, :pitch 58} {:time 177, :instrument 15, :pitch 58} {:time 176, :instrument 15, :pitch 58} {:time 143.5, :instrument 5, :pitch 67} {:time 143, :instrument 5, :pitch 67} {:time 142, :instrument 5, :pitch 67} {:time 141.5, :instrument 5, :pitch 68} {:time 141, :instrument 5, :pitch 68} {:time 140, :instrument 5, :pitch 68} {:time 139.5, :instrument 5, :pitch 69} {:time 139, :instrument 5, :pitch 69} {:time 138, :instrument 5, :pitch 69} {:time 137.5, :instrument 5, :pitch 70} {:time 137, :instrument 5, :pitch 70} {:time 136, :instrument 5, :pitch 70} {:time 135, :instrument 5, :pitch 74} {:time 134, :instrument 5, :pitch 72} {:time 133.5, :instrument 5, :pitch 70} {:time 133, :instrument 5, :pitch 69} {:time 132, :instrument 5, :pitch 69} {:time 131.5, :instrument 5, :pitch 67} {:time 131, :instrument 5, :pitch 65} {:time 128, :instrument 5, :pitch 65} {:time 127.5, :instrument 5, :pitch 66} {:time 127, :instrument 5, :pitch 68} {:time 124, :instrument 5, :pitch 70} {:time 123.5, :instrument 5, :pitch 68} {:time 123, :instrument 5, :pitch 66} {:time 122, :instrument 5, :pitch 68} {:time 121.5, :instrument 5, :pitch 66} {:time 121, :instrument 5, :pitch 66} {:time 120, :instrument 5, :pitch 66} {:time 119, :instrument 5, :pitch 68} {:time 118, :instrument 5, :pitch 70} {:time 115.5, :instrument 5, :pitch 70} {:time 115, :instrument 5, :pitch 68} {:time 114, :instrument 5, :pitch 70} {:time 113.5, :instrument 5, :pitch 68} {:time 113, :instrument 5, :pitch 68} {:time 112, :instrument 5, :pitch 68} {:time 110, :instrument 5, :pitch 70} {:time 106, :instrument 5, :pitch 70} {:time 104, :instrument 5, :pitch 75} {:time 96, :instrument 5, :pitch 72} {:time 95.5, :instrument 5, :pitch 77} {:time 95, :instrument 5, :pitch 76} {:time 94, :instrument 5, :pitch 74} {:time 93, :instrument 5, :pitch 74} {:time 93, :instrument 5, :pitch 71} {:time 96, :instrument 6, :pitch 76} {:time 95.5, :instrument 6, :pitch 74} {:time 95, :instrument 6, :pitch 72} {:time 94, :instrument 6, :pitch 71} {:time 96, :instrument 5, :pitch 76} {:time 95.5, :instrument 5, :pitch 74} {:time 95, :instrument 5, :pitch 72} {:time 94, :instrument 5, :pitch 71} {:time 92, :instrument 6, :pitch 71} {:time 91.5, :instrument 6, :pitch 69} {:time 91, :instrument 6, :pitch 68} {:time 90.5, :instrument 6, :pitch 66} {:time 90, :instrument 6, :pitch 64} {:time 89, :instrument 6, :pitch 64} {:time 88, :instrument 5, :pitch 74} {:time 87.5, :instrument 5, :pitch 73} {:time 87, :instrument 5, :pitch 71} {:time 86.5, :instrument 5, :pitch 69} {:time 86, :instrument 5, :pitch 68} {:time 85, :instrument 5, :pitch 68} {:time 88, :instrument 5, :pitch 71} {:time 87.5, :instrument 5, :pitch 69} {:time 87, :instrument 5, :pitch 68} {:time 86.5, :instrument 5, :pitch 66} {:time 86, :instrument 5, :pitch 64} {:time 85, :instrument 5, :pitch 64} {:time 87, :instrument 2, :pitch 55} {:time 87.5, :instrument 2, :pitch 55} {:time 88, :instrument 2, :pitch 55} {:time 89, :instrument 2, :pitch 55} {:time 89.5, :instrument 2, :pitch 55} {:time 90, :instrument 2, :pitch 55} {:time 91, :instrument 2, :pitch 57} {:time 91.5, :instrument 2, :pitch 57} {:time 92, :instrument 2, :pitch 57} {:time 93, :instrument 2, :pitch 57} {:time 93.5, :instrument 2, :pitch 57} {:time 94, :instrument 2, :pitch 55} {:time 95, :instrument 2, :pitch 57} {:time 95.5, :instrument 2, :pitch 55} {:time 96, :instrument 2, :pitch 55} {:time 97, :instrument 2, :pitch 55} {:time 97.5, :instrument 2, :pitch 55} {:time 98, :instrument 2, :pitch 55} {:time 99, :instrument 2, :pitch 55} {:time 99.5, :instrument 2, :pitch 55} {:time 100, :instrument 2, :pitch 55} {:time 101, :instrument 2, :pitch 57} {:time 101.5, :instrument 2, :pitch 57} {:time 102, :instrument 2, :pitch 57} {:time 103, :instrument 2, :pitch 55} {:time 103.5, :instrument 2, :pitch 55} {:time 104, :instrument 2, :pitch 55} {:time 105, :instrument 2, :pitch 55} {:time 105.5, :instrument 2, :pitch 55} {:time 106, :instrument 2, :pitch 55} {:time 107, :instrument 2, :pitch 55} {:time 107.5, :instrument 2, :pitch 57} {:time 108, :instrument 2, :pitch 57} {:time 109, :instrument 2, :pitch 55} {:time 109.5, :instrument 2, :pitch 57} {:time 110, :instrument 2, :pitch 57} {:time 111, :instrument 2, :pitch 57} {:time 111.5, :instrument 2, :pitch 57} {:time 112, :instrument 2, :pitch 57} {:time 113, :instrument 2, :pitch 55} {:time 113.5, :instrument 2, :pitch 55} {:time 114, :instrument 2, :pitch 57} {:time 115, :instrument 2, :pitch 57} {:time 115.5, :instrument 2, :pitch 55} {:time 116, :instrument 2, :pitch 55} {:time 117, :instrument 2, :pitch 55} {:time 117.5, :instrument 2, :pitch 55} {:time 118, :instrument 2, :pitch 55} {:time 119, :instrument 2, :pitch 55} {:time 119.5, :instrument 2, :pitch 55} {:time 120, :instrument 2, :pitch 57} {:time 121, :instrument 2, :pitch 57} {:time 121.5, :instrument 2, :pitch 55} {:time 122, :instrument 2, :pitch 55} {:time 123, :instrument 2, :pitch 55} {:time 123.5, :instrument 2, :pitch 55} {:time 124, :instrument 2, :pitch 55} {:time 125, :instrument 2, :pitch 55} {:time 125.5, :instrument 2, :pitch 55} {:time 126, :instrument 2, :pitch 55} {:time 127, :instrument 2, :pitch 57} {:time 127.5, :instrument 2, :pitch 55} {:time 128, :instrument 2, :pitch 55} {:time 129, :instrument 2, :pitch 55} {:time 129.5, :instrument 2, :pitch 55} {:time 130, :instrument 2, :pitch 55} {:time 131, :instrument 2, :pitch 55} {:time 131.5, :instrument 2, :pitch 55} {:time 132, :instrument 2, :pitch 57} {:time 133, :instrument 2, :pitch 55} {:time 133.5, :instrument 2, :pitch 55} {:time 134, :instrument 2, :pitch 55} {:time 134.5, :instrument 2, :pitch 57} {:time 135, :instrument 2, :pitch 59} {:time 136, :instrument 2, :pitch 60} {:time 135.5, :instrument 2, :pitch 59} {:time 137, :instrument 2, :pitch 55} {:time 137.5, :instrument 2, :pitch 55} {:time 138, :instrument 2, :pitch 55} {:time 139, :instrument 2, :pitch 55} {:time 139.5, :instrument 2, :pitch 55} {:time 140, :instrument 2, :pitch 55} {:time 141, :instrument 2, :pitch 55} {:time 141.5, :instrument 2, :pitch 55} {:time 142, :instrument 2, :pitch 55} {:time 143, :instrument 2, :pitch 55} {:time 143.5, :instrument 2, :pitch 55} {:time 144, :instrument 2, :pitch 55} {:time 145, :instrument 2, :pitch 55} {:time 145.5, :instrument 2, :pitch 55} {:time 146, :instrument 2, :pitch 55} {:time 147, :instrument 2, :pitch 55} {:time 147.5, :instrument 2, :pitch 55} {:time 148, :instrument 2, :pitch 55} {:time 149, :instrument 2, :pitch 55} {:time 149.5, :instrument 2, :pitch 55} {:time 149.5, :instrument 2, :pitch 55} {:time 150, :instrument 2, :pitch 57} {:time 151, :instrument 2, :pitch 55} {:time 151.5, :instrument 2, :pitch 55} {:time 152, :instrument 2, :pitch 55} {:time 153, :instrument 2, :pitch 55} {:time 153.5, :instrument 2, :pitch 55} {:time 154, :instrument 2, :pitch 55} {:time 155, :instrument 2, :pitch 55} {:time 155.5, :instrument 2, :pitch 55} {:time 156, :instrument 2, :pitch 55} {:time 157, :instrument 2, :pitch 57} {:time 157.5, :instrument 2, :pitch 55} {:time 158, :instrument 2, :pitch 55} {:time 167.5, :instrument 2, :pitch 55} {:time 167, :instrument 2, :pitch 55} {:time 166, :instrument 2, :pitch 55} {:time 165.5, :instrument 2, :pitch 55} {:time 165, :instrument 2, :pitch 57} {:time 164, :instrument 2, :pitch 55} {:time 163.5, :instrument 2, :pitch 55} {:time 163, :instrument 2, :pitch 55} {:time 162, :instrument 2, :pitch 55} {:time 161.5, :instrument 2, :pitch 57} {:time 161, :instrument 2, :pitch 55} {:time 160, :instrument 2, :pitch 57} {:time 159.5, :instrument 2, :pitch 57} {:time 159, :instrument 2, :pitch 57} {:time 175.5, :instrument 2, :pitch 57} {:time 175, :instrument 2, :pitch 57} {:time 174, :instrument 2, :pitch 57} {:time 173.5, :instrument 2, :pitch 57} {:time 173, :instrument 2, :pitch 57} {:time 172, :instrument 2, :pitch 57} {:time 171.5, :instrument 2, :pitch 57} {:time 171, :instrument 2, :pitch 57} {:time 170, :instrument 2, :pitch 57} {:time 169.5, :instrument 2, :pitch 57} {:time 169, :instrument 2, :pitch 57} {:time 168, :instrument 2, :pitch 57} {:time 184, :instrument 2, :pitch 55} {:time 183.5, :instrument 2, :pitch 55} {:time 183, :instrument 2, :pitch 55} {:time 181.5, :instrument 2, :pitch 55} {:time 181, :instrument 2, :pitch 55} {:time 180, :instrument 2, :pitch 55} {:time 179.5, :instrument 2, :pitch 55} {:time 179, :instrument 2, :pitch 55} {:time 184, :instrument 15, :pitch 59} {:time 175.5, :instrument 15, :pitch 59} {:time 175, :instrument 15, :pitch 59} {:time 174, :instrument 15, :pitch 59} {:time 173.5, :instrument 15, :pitch 59} {:time 173, :instrument 15, :pitch 59} {:time 172, :instrument 15, :pitch 59} {:time 171.5, :instrument 15, :pitch 59} {:time 171, :instrument 15, :pitch 59} {:time 170, :instrument 15, :pitch 59} {:time 169.5, :instrument 15, :pitch 59} {:time 169, :instrument 15, :pitch 59} {:time 168, :instrument 15, :pitch 59} {:time 167.5, :instrument 15, :pitch 60} {:time 167, :instrument 15, :pitch 60} {:time 166, :instrument 15, :pitch 60} {:time 165.5, :instrument 15, :pitch 60} {:time 165, :instrument 15, :pitch 60} {:time 164, :instrument 15, :pitch 60} {:time 163.5, :instrument 15, :pitch 60} {:time 163, :instrument 15, :pitch 60} {:time 162, :instrument 15, :pitch 60} {:time 161.5, :instrument 15, :pitch 60} {:time 161, :instrument 15, :pitch 60} {:time 160, :instrument 15, :pitch 60} {:time 159.5, :instrument 15, :pitch 62} {:time 159, :instrument 15, :pitch 62} {:time 158, :instrument 15, :pitch 62} {:time 157.5, :instrument 15, :pitch 62} {:time 157, :instrument 15, :pitch 62} {:time 156, :instrument 15, :pitch 62} {:time 155.5, :instrument 15, :pitch 62} {:time 155, :instrument 15, :pitch 62} {:time 154, :instrument 15, :pitch 62} {:time 153.5, :instrument 15, :pitch 62} {:time 153, :instrument 15, :pitch 62} {:time 152, :instrument 15, :pitch 62} {:time 151.5, :instrument 15, :pitch 64} {:time 151, :instrument 15, :pitch 64} {:time 150, :instrument 15, :pitch 64} {:time 149.5, :instrument 15, :pitch 64} {:time 149, :instrument 15, :pitch 64} {:time 148, :instrument 15, :pitch 64} {:time 147.5, :instrument 15, :pitch 64} {:time 147, :instrument 15, :pitch 64} {:time 146, :instrument 15, :pitch 64} {:time 145.5, :instrument 15, :pitch 64} {:time 145, :instrument 15, :pitch 64} {:time 144, :instrument 15, :pitch 64} {:time 143.5, :instrument 15, :pitch 59} {:time 143, :instrument 15, :pitch 59} {:time 142, :instrument 15, :pitch 59} {:time 141.5, :instrument 15, :pitch 59} {:time 141, :instrument 15, :pitch 59} {:time 139.5, :instrument 15, :pitch 59} {:time 139, :instrument 15, :pitch 59} {:time 137.5, :instrument 15, :pitch 59} {:time 137, :instrument 15, :pitch 59} {:time 140, :instrument 15, :pitch 59} {:time 138, :instrument 15, :pitch 59} {:time 136, :instrument 15, :pitch 71} {:time 135.5, :instrument 15, :pitch 66} {:time 135, :instrument 15, :pitch 66} {:time 134, :instrument 15, :pitch 66} {:time 133.5, :instrument 15, :pitch 66} {:time 133, :instrument 15, :pitch 66} {:time 132, :instrument 15, :pitch 66} {:time 131.5, :instrument 15, :pitch 66} {:time 131, :instrument 15, :pitch 66} {:time 130, :instrument 15, :pitch 66} {:time 129.5, :instrument 15, :pitch 66} {:time 129, :instrument 15, :pitch 66} {:time 128, :instrument 15, :pitch 66} {:time 127.5, :instrument 15, :pitch 64} {:time 127, :instrument 15, :pitch 64} {:time 126, :instrument 15, :pitch 64} {:time 125.5, :instrument 15, :pitch 64} {:time 125, :instrument 15, :pitch 64} {:time 124, :instrument 15, :pitch 64} {:time 123.5, :instrument 15, :pitch 64} {:time 123, :instrument 15, :pitch 64} {:time 122, :instrument 15, :pitch 64} {:time 121.5, :instrument 15, :pitch 64} {:time 121, :instrument 15, :pitch 64} {:time 120, :instrument 15, :pitch 64} {:time 119.5, :instrument 15, :pitch 65} {:time 119, :instrument 15, :pitch 65} {:time 118, :instrument 15, :pitch 65} {:time 117.5, :instrument 15, :pitch 65} {:time 117, :instrument 15, :pitch 65} {:time 116, :instrument 15, :pitch 65} {:time 115.5, :instrument 15, :pitch 65} {:time 115, :instrument 15, :pitch 65} {:time 114, :instrument 15, :pitch 65} {:time 113.5, :instrument 15, :pitch 65} {:time 113, :instrument 15, :pitch 65} {:time 112, :instrument 15, :pitch 65} {:time 111.5, :instrument 15, :pitch 67} {:time 111, :instrument 15, :pitch 67} {:time 110, :instrument 15, :pitch 67} {:time 109.5, :instrument 15, :pitch 67} {:time 109, :instrument 15, :pitch 67} {:time 108, :instrument 15, :pitch 67} {:time 107.5, :instrument 15, :pitch 67} {:time 107, :instrument 15, :pitch 67} {:time 106, :instrument 15, :pitch 67} {:time 105.5, :instrument 15, :pitch 67} {:time 105, :instrument 15, :pitch 67} {:time 104, :instrument 15, :pitch 67} {:time 103.5, :instrument 15, :pitch 60} {:time 103, :instrument 15, :pitch 60} {:time 102, :instrument 15, :pitch 60} {:time 101.5, :instrument 15, :pitch 60} {:time 101, :instrument 15, :pitch 60} {:time 100, :instrument 15, :pitch 60} {:time 99.5, :instrument 15, :pitch 60} {:time 99, :instrument 15, :pitch 60} {:time 98, :instrument 15, :pitch 60} {:time 97.5, :instrument 15, :pitch 60} {:time 97, :instrument 15, :pitch 60} {:time 96, :instrument 15, :pitch 60} {:time 95.5, :instrument 15, :pitch 62} {:time 95, :instrument 15, :pitch 62} {:time 94, :instrument 15, :pitch 62} {:time 93.5, :instrument 15, :pitch 62} {:time 93, :instrument 15, :pitch 62} {:time 92, :instrument 15, :pitch 62} {:time 91.5, :instrument 15, :pitch 62} {:time 91, :instrument 15, :pitch 62} {:time 90, :instrument 15, :pitch 62} {:time 89.5, :instrument 15, :pitch 62} {:time 89, :instrument 15, :pitch 62} {:time 88, :instrument 15, :pitch 62} {:time 87.5, :instrument 15, :pitch 64} {:time 87, :instrument 15, :pitch 64} {:time 86, :instrument 15, :pitch 64} {:time 85.5, :instrument 15, :pitch 64} {:time 85, :instrument 15, :pitch 64} {:time 82, :instrument 5, :pitch 64} {:time 80, :instrument 5, :pitch 68} {:time 82, :instrument 5, :pitch 59} {:time 80, :instrument 5, :pitch 64} {:time 84, :instrument 15, :pitch 64} {:time 83.5, :instrument 15, :pitch 64} {:time 83, :instrument 15, :pitch 64} {:time 82, :instrument 15, :pitch 64} {:time 81.5, :instrument 15, :pitch 64} {:time 80, :instrument 15, :pitch 64} {:time 81, :instrument 15, :pitch 64} {:time 76, :instrument 6, :pitch 71} {:time 75.5, :instrument 6, :pitch 69} {:time 75, :instrument 6, :pitch 68} {:time 74.5, :instrument 6, :pitch 66} {:time 74, :instrument 6, :pitch 64} {:time 73, :instrument 6, :pitch 64} {:time 72, :instrument 5, :pitch 71} {:time 71.5, :instrument 5, :pitch 69} {:time 71, :instrument 5, :pitch 68} {:time 70.5, :instrument 5, :pitch 66} {:time 70, :instrument 5, :pitch 64} {:time 69, :instrument 5, :pitch 64} {:time 66, :instrument 5, :pitch 59} {:time 64, :instrument 5, :pitch 64} {:time 79.5, :instrument 15, :pitch 59} {:time 79, :instrument 15, :pitch 59} {:time 78, :instrument 15, :pitch 59} {:time 77.5, :instrument 15, :pitch 59} {:time 77, :instrument 15, :pitch 59} {:time 76, :instrument 15, :pitch 59} {:time 75.5, :instrument 15, :pitch 59} {:time 75, :instrument 15, :pitch 59} {:time 74, :instrument 15, :pitch 59} {:time 73.5, :instrument 15, :pitch 59} {:time 73, :instrument 15, :pitch 59} {:time 72, :instrument 15, :pitch 59} {:time 60, :instrument 6, :pitch 71} {:time 59.5, :instrument 6, :pitch 69} {:time 59, :instrument 6, :pitch 68} {:time 58.5, :instrument 6, :pitch 66} {:time 58, :instrument 6, :pitch 64} {:time 57, :instrument 6, :pitch 64} {:time 56, :instrument 5, :pitch 71} {:time 55.5, :instrument 5, :pitch 69} {:time 55, :instrument 5, :pitch 68} {:time 54.5, :instrument 5, :pitch 66} {:time 54, :instrument 5, :pitch 64} {:time 53, :instrument 5, :pitch 64} {:time 86, :instrument 2, :pitch 57} {:time 85.5, :instrument 2, :pitch 57} {:time 85, :instrument 2, :pitch 57} {:time 84, :instrument 2, :pitch 57} {:time 83.5, :instrument 2, :pitch 57} {:time 83, :instrument 2, :pitch 57} {:time 82, :instrument 2, :pitch 57} {:time 81.5, :instrument 2, :pitch 57} {:time 81, :instrument 2, :pitch 57} {:time 80, :instrument 2, :pitch 57} {:time 79.5, :instrument 2, :pitch 57} {:time 79, :instrument 2, :pitch 57} {:time 78, :instrument 2, :pitch 57} {:time 77.5, :instrument 2, :pitch 57} {:time 77, :instrument 2, :pitch 57} {:time 76, :instrument 2, :pitch 57} {:time 75.5, :instrument 2, :pitch 57} {:time 75, :instrument 2, :pitch 57} {:time 74, :instrument 2, :pitch 57} {:time 73.5, :instrument 2, :pitch 55} {:time 73, :instrument 2, :pitch 57} {:time 73, :instrument 2, :pitch 57} {:time 72, :instrument 2, :pitch 55} {:time 71.5, :instrument 2, :pitch 55} {:time 71, :instrument 2, :pitch 55} {:time 70, :instrument 2, :pitch 55} {:time 69.5, :instrument 2, :pitch 55} {:time 69, :instrument 2, :pitch 55} {:time 68, :instrument 2, :pitch 55} {:time 67.5, :instrument 2, :pitch 55} {:time 67, :instrument 2, :pitch 55} {:time 66, :instrument 2, :pitch 55} {:time 65.5, :instrument 2, :pitch 55} {:time 65, :instrument 2, :pitch 55} {:time 64, :instrument 2, :pitch 55} {:time 63.5, :instrument 2, :pitch 57} {:time 63, :instrument 2, :pitch 57} {:time 62, :instrument 2, :pitch 57} {:time 61.5, :instrument 2, :pitch 57} {:time 61, :instrument 2, :pitch 57} {:time 60, :instrument 2, :pitch 57} {:time 59.5, :instrument 2, :pitch 57} {:time 59, :instrument 2, :pitch 57} {:time 58, :instrument 2, :pitch 57} {:time 57.5, :instrument 2, :pitch 57} {:time 57, :instrument 2, :pitch 57} {:time 56, :instrument 2, :pitch 57} {:time 55.5, :instrument 2, :pitch 59} {:time 55, :instrument 2, :pitch 59} {:time 54, :instrument 2, :pitch 59} {:time 53.5, :instrument 2, :pitch 59} {:time 53, :instrument 2, :pitch 59} {:time 50, :instrument 5, :pitch 59} {:time 48, :instrument 5, :pitch 64} {:time 48, :instrument 12, :pitch 67} {:time 47.5, :instrument 12, :pitch 64} {:time 47, :instrument 12, :pitch 59} {:time 41, :instrument 12, :pitch 64} {:time 40, :instrument 12, :pitch 67} {:time 39.5, :instrument 12, :pitch 64} {:time 39, :instrument 12, :pitch 59} {:time 33, :instrument 12, :pitch 64} {:time 52, :instrument 2, :pitch 59} {:time 51.5, :instrument 2, :pitch 59} {:time 51, :instrument 2, :pitch 59} {:time 50, :instrument 2, :pitch 59} {:time 49.5, :instrument 2, :pitch 59} {:time 49, :instrument 2, :pitch 59} {:time 48, :instrument 2, :pitch 59} {:time 71.5, :instrument 15, :pitch 60} {:time 71, :instrument 15, :pitch 60} {:time 70, :instrument 15, :pitch 60} {:time 69.5, :instrument 15, :pitch 60} {:time 69, :instrument 15, :pitch 60} {:time 68, :instrument 15, :pitch 60} {:time 67.5, :instrument 15, :pitch 60} {:time 67, :instrument 15, :pitch 60} {:time 66, :instrument 15, :pitch 60} {:time 65.5, :instrument 15, :pitch 60} {:time 65, :instrument 15, :pitch 60} {:time 64, :instrument 15, :pitch 60} {:time 63.5, :instrument 15, :pitch 62} {:time 63, :instrument 15, :pitch 62} {:time 62, :instrument 15, :pitch 62} {:time 61.5, :instrument 15, :pitch 62} {:time 61, :instrument 15, :pitch 62} {:time 60, :instrument 15, :pitch 62} {:time 59.5, :instrument 15, :pitch 62} {:time 59, :instrument 15, :pitch 62} {:time 58, :instrument 15, :pitch 62} {:time 57.5, :instrument 15, :pitch 62} {:time 57, :instrument 15, :pitch 62} {:time 56, :instrument 15, :pitch 62} {:time 55.5, :instrument 15, :pitch 64} {:time 55, :instrument 15, :pitch 64} {:time 54, :instrument 15, :pitch 64} {:time 53.5, :instrument 15, :pitch 64} {:time 53, :instrument 15, :pitch 64} {:time 52, :instrument 15, :pitch 64} {:time 51.5, :instrument 15, :pitch 64} {:time 51, :instrument 15, :pitch 64} {:time 50, :instrument 15, :pitch 64} {:time 49.5, :instrument 15, :pitch 64} {:time 49, :instrument 15, :pitch 64} {:time 48, :instrument 15, :pitch 64} {:time 44, :instrument 13, :pitch 72} {:time 47.5, :instrument 15, :pitch 64} {:time 47, :instrument 15, :pitch 64} {:time 46, :instrument 15, :pitch 64} {:time 45.5, :instrument 15, :pitch 64} {:time 45, :instrument 15, :pitch 64} {:time 44, :instrument 15, :pitch 64} {:time 43.5, :instrument 15, :pitch 64} {:time 43, :instrument 15, :pitch 64} {:time 42, :instrument 15, :pitch 64} {:time 41.5, :instrument 15, :pitch 64} {:time 41, :instrument 15, :pitch 64} {:time 47.5, :instrument 2, :pitch 59} {:time 47, :instrument 2, :pitch 59} {:time 46, :instrument 2, :pitch 59} {:time 45.5, :instrument 2, :pitch 59} {:time 45, :instrument 2, :pitch 60} {:time 44, :instrument 2, :pitch 59} {:time 43.5, :instrument 2, :pitch 59} {:time 43, :instrument 2, :pitch 59} {:time 42, :instrument 2, :pitch 59} {:time 41.5, :instrument 2, :pitch 59} {:time 41, :instrument 2, :pitch 59} {:time 40, :instrument 2, :pitch 59} {:time 39.5, :instrument 2, :pitch 59} {:time 39, :instrument 2, :pitch 59} {:time 38, :instrument 2, :pitch 59} {:time 37.5, :instrument 2, :pitch 59} {:time 37, :instrument 2, :pitch 59} {:time 24, :instrument 12, :pitch 71} {:time 36, :instrument 13, :pitch 72} {:time 35.5, :instrument 2, :pitch 59} {:time 35, :instrument 2, :pitch 59} {:time 34, :instrument 2, :pitch 59} {:time 33.5, :instrument 2, :pitch 59} {:time 33, :instrument 2, :pitch 59} {:time 31.5, :instrument 12, :pitch 64} {:time 31, :instrument 12, :pitch 59} {:time 32, :instrument 12, :pitch 67} {:time 15, :instrument 12, :pitch 67} {:time 15.5, :instrument 12, :pitch 72} {:time -2, :instrument 12, :pitch 64} {:time -1.5, :instrument 12, :pitch 67} {:time -1, :instrument 12, :pitch 71} {:time 40, :instrument 15, :pitch 64} {:time 39.5, :instrument 15, :pitch 64} {:time 39, :instrument 15, :pitch 64} {:time 38, :instrument 15, :pitch 64} {:time 37.5, :instrument 15, :pitch 64} {:time 37, :instrument 15, :pitch 64} {:time 36, :instrument 15, :pitch 64} {:time 35.5, :instrument 15, :pitch 64} {:time 35, :instrument 15, :pitch 64} {:time 36, :instrument 2, :pitch 59} {:time 32, :instrument 2, :pitch 59} {:time 34, :instrument 15, :pitch 64} {:time 33.5, :instrument 15, :pitch 64} {:time 33, :instrument 15, :pitch 64} {:time 32, :instrument 15, :pitch 64} {:time 25, :instrument 12, :pitch 75} {:time 24.5, :instrument 12, :pitch 73} {:time 24, :instrument 12, :pitch 75} {:time 23, :instrument 12, :pitch 76} {:time 22, :instrument 12, :pitch 72} {:time 21, :instrument 12, :pitch 72} {:time 16, :instrument 12, :pitch 76} {:time 6, :instrument 12, :pitch 71} {:time 9, :instrument 12, :pitch 74} {:time 8.5, :instrument 12, :pitch 72} {:time 8, :instrument 12, :pitch 74} {:time 7, :instrument 12, :pitch 76} {:time 5, :instrument 12, :pitch 71} {:time 0, :instrument 12, :pitch 76} {:time 26, :instrument 15, :pitch 66} {:time 24, :instrument 15, :pitch 59} {:time 0, :instrument 15, :pitch 64} {:time 2, :instrument 15, :pitch 71} {:time 4, :instrument 15, :pitch 76} {:time 8, :instrument 15, :pitch 62} {:time 10, :instrument 15, :pitch 69} {:time 12, :instrument 15, :pitch 74} {:time 16, :instrument 15, :pitch 60} {:time 18, :instrument 15, :pitch 67} {:time 20, :instrument 15, :pitch 72} {:time 28, :instrument 15, :pitch 71}
]
)))

(reg-event-db
 :remove-note
 (undoable "remove note")
 (fn [db [_ time pitch]]
   (update db :notes
              (fn [note]
                (remove #(and (= time (:time %))
                              (= pitch (:pitch %)))
                        note)))))

(reg-event-db
 :set-time-signature
 (fn [db [_ beats-per-measure]]
   (update db :time-signature beats-per-measure)))

(reg-event-db
 :set-notes
 (fn [db [_ notes]]
   (assoc db :notes notes)))

(reg-event-db                 ;; usage:  (dispatch [:timer a-js-Date])
 :timer                         ;; every second an event of this kind will be dispatched
 (fn [db [_ new-time]]          ;; note how the 2nd parameter is destructured to obtain the data value
   (assoc db :time new-time)))

(reg-event-db
 :play-on
 (fn [db [_ _]]
   (music/play-song!)
   (assoc 
    (assoc db :play-start (.-currentTime @audiocontext))
    :playing? true)))

(reg-event-db
 :sharp-on
 (fn [db [_ _]]
    (assoc db :sharp? true)))

(reg-event-db
 :sharp-toggle
 (fn [db [_ _]]
   (update db :sharp? not)))

(reg-event-db
 :eraser-toggle
 (fn [db [_ _]]
   (update db :eraser? not)))

(reg-event-db
 :sharp-off
 (fn [db [_ _]]
   (assoc db :sharp? false)))

(reg-event-db
 :pause
 (fn [db [_ _]]
    (assoc db :playing? false)))

(reg-event-db
 :stop
 (fn [db [_ _]]
   (dispatch [:reset-editor])
   (assoc 
    (assoc db :playing? false)
    :current-position 0)))

(reg-event-db
 :update-focus-note
 (fn [db [_ pos]]
   (assoc db :focused-note-pos pos)))

(reg-event-db
 :select-instrument
 (fn [db [_ instrument]]
   (assoc db :instrument instrument)))

(reg-event-db
 :play-off
 (fn [db [_ _]]
   (assoc db :playing? false)))

 
(reg-event-db
 :advance-position
 (fn [db [_ _]]
   (let [notes (subscribe [:notes])
         beat (subscribe [:current-position])
         to-play (filter #(= (+ 1 @beat) (:time %)) @notes)]
     (if (< 8 @beat)
       (dispatch [:advance-editor]))
     #_(doall (for [{:keys [instrument pitch]} to-play]
              (music/play-sample instrument (if @(subscribe [:sharp?]) (+ 0.5 pitch) pitch))))
     (update db :current-position #(+ 0.5 %)))))

(reg-event-db
 :advance-editor
 (fn [db [_ _]]
   (update db :editor-beat-start #(+ 0.5 %))))

(reg-event-db
 :move-mario
 (fn [db [_ x]]
   (assoc db :mario-x x)))

(reg-event-db
 :reset-editor
 (fn [db [_ _]]
   (assoc db :editor-beat-start 1)))

(reg-event-db
 :retract-editor
 (fn [db [_ _]]
   (update db :editor-beat-start #(- % 0.5))))

(reg-event-db
 :reset-position
 (fn [db [_ _]]
   (assoc db :current-position 0)))

(reg-event-db
 :set-tempo
 (fn [db [_ tempo]]
   (assoc db :tempo tempo)))

(reg-event-db
 :inc-tempo
 (fn [db [_ tempo]]
   (update db :tempo #(+ 8 %))))

(reg-event-db
 :dec-tempo
 (fn [db [_ tempo]]
   (update db :tempo #(- % 8))))

(reg-event-db
 :set-key
 (fn [db [_ key]]
   (assoc db :key key)))

(reg-event-db
 :tick!
 (fn [db [_ _]]
   (if (not= 0 @(subscribe [:mario-jump]))
     (assoc
      (update
       (update db :mario-run #(if (= % 3) 1 (inc %)))
       :mario-jump #(if (= 7 %) 0 (inc %)))
      :mario-y (- 59 (nth (concat
                           (range 0 32 8)
                           (reverse (range 0 32 8)))
                          (mod @(subscribe [:mario-jump]) 8))))
     (update db :mario-run #(if (= % 3) 1 (inc %))))))

(reg-event-db
 :jump!
 (fn [db [_ _]]
     (update db :mario-jump inc)))

(reg-event-db
 :submit-xml
 (fn [db [_ xml]]
    (assoc db :xml xml)))
